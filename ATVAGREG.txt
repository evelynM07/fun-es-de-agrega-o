/* ANOTAÇÕES- aula 17/10*/

SELECT MAX(m.ESTOQUE) AS MAIOR_ESTOQUE 
	 , MIN(m.PRECO) AS MENOR_PRECO
	 , AVG(m.PRECO) AS MEDIA_PRECO
FROM MEDICAMENTOS m

SELECT * FROM MEDICAMENTOS m 

CREATE TABLE PRODUTOS(
	CODIGO integer PRIMARY KEY,
	DESCRICAO varchar(254),
	PRECOVENDA decimal(10,2),
	PRECOCUSTO decimal(10,2),
	CATEGORIA integer
);

INSERT INTO PRODUTOS 
	(CODIGO, DESCRICAO, PRECOVENDA, PRECOCUSTO, CATEGORIA)
VALUES (
	1, 'caderno', NULL, 1.55, 2);

INSERT INTO PRODUTOS 
	(CODIGO, DESCRICAO, PRECOVENDA, PRECOCUSTO, CATEGORIA)
VALUES (
	2, 'caneta', 1.34, 2.58, 2);

INSERT INTO PRODUTOS 
	(CODIGO, DESCRICAO, PRECOVENDA, PRECOCUSTO, CATEGORIA)
VALUES (
	3, 'disquete', 2.56, 4.67, 2);

INSERT INTO PRODUTOS 
	(CODIGO, DESCRICAO, PRECOVENDA, PRECOCUSTO, CATEGORIA)
VALUES (
	4, 'mouse', 19.99, 38.54, 1);

SELECT MAX(p.PRECOVENDA)
	FROM PRODUTOS p
	
SELECT MIN(p.PRECOVENDA)
	FROM PRODUTOS p
	WHERE p.CATEGORIA = 2
	
SELECT * FROM PRODUTOS p

SELECT AVG(p.PRECOVENDA)
	FROM PRODUTOS p 
	
SELECT COUNT(*) /*TODOS OS  ITENS*/
FROM PRODUTOS p 
WHERE p.CATEGORIA = 2

SELECT COUNT(PRECOVENDA) /*IGNORA OS NULL*/
FROM PRODUTOS p 
WHERE p.CATEGORIA = 2

SELECT p.CATEGORIA
	, MAX(p.PRECOVENDA)
   FROM PRODUTOS p 
   
SELECT p.CATEGORIA
	, MAX(p.PRECOVENDA)
   FROM PRODUTOS p
  GROUP BY p.CATEGORIA 
  
SELECT p.CATEGORIA
	, MAX(p.PRECOVENDA)
   FROM PRODUTOS p
  GROUP BY p.CATEGORIA 
  HAVING MAX(p.PRECOVENDA) > 10 
  
SELECT p.CATEGORIA
	, AVG(p.PRECOCUSTO)
   FROM PRODUTOS p
  GROUP BY p.CATEGORIA 
  HAVING AVG(p.PRECOCUSTO) > 5
  
SELECT DISTINCT i.ID_RECEITA
	FROM ITENSRECEITA i
	
ALTER TABLE ITENSRECEITA ADD TOTAL_ITENS NUMERIC


UPDATE ITENSRECEITA i SET TOTAL_ITENS = 
(SELECT (m.PRECO * i.QUANTIDADE)
	FROM MEDICAMENTOS m
	WHERE i.ID_MEDICAMENTO = m.ID_MEDICAMENTO);
	

SELECT ID_TUTOR, UPPER(NOME) AS NOME FROM TUTOR t 
UNION
SELECT ID_PACIENTE,





/*EXERCICIO 1*/
SELECT SUM(m.estoque) AS MEDICAMENTO_ESTOQUE
FROM MEDICAMENTOS m

/*EXERCICIO 2*/
SELECT AVG(EXTRACT (YEAR FROM current_date) - EXTRACT(YEAR FROM t.DATA_NASCIMENTO)) AS MEDIA_IDADE
FROM TUTOR t


/*EXERCICIO 3*/
SELECT MIN(m.preco) FROM MEDICAMENTOS m


/*EXERCICIO 4*/
SELECT MAX(p.peso) FROM PACIENTE p


/*EXERCICIO 5*/
SELECT COUNT(t.id_tutor) FROM TUTOR t


/*EXERCICIO 6*/
SELECT m.UNIDADE, sum(m.preco * m.estoque) AS VALOR_TOTAL
FROM MEDICAMENTOS m
GROUP BY m.UNIDADE


/*EXERCICIO 7*/
SELECT i.ID_RECEITA
   , sum(i.total_item)
   FROM ITENSRECEITA i
   GROUP BY i.ID_RECEITA
   HAVING sum(i.total_item) > 100